ENKINS_URL="http://your-jenkins-server/"
CLI_JAR="jenkins-cli.jar"

# Create a directory to store job configurations
mkdir -p job_configs

# List all job names and download configurations
java -jar $CLI_JAR -s $JENKINS_URL list-jobs | while read -r job; do
  echo "Downloading configuration for job: $job"
  java -jar $CLI_JAR -s $JENKINS_URL get-job "$job" > "job_configs/$job.xml"
done





@echo off
setlocal enabledelayedexpansion

set JENKINS_URL=https://jenkins.smartfoodsafe.net/jenkins/
set CLI_JAR=jenkins-cli.jar

# Create a directory to store job configurations
mkdir job_configs 2>nul

#List all job names and download configurations
for /f "delims=" %%i in ('java -jar %CLI_JAR% -s %JENKINS_URL% list-jobs') do (
    set "job=%%i"
    echo Downloading configuration for job: !job!
    java -jar %CLI_JAR% -s %JENKINS_URL% get-job "!job!" > "job_configs\!job!.xml"
)

#Install all plugins from the job configurations
for %%f in (job_configs\*.xml) do (
    set "job_config=%%~ff"
    echo Installing plugins from job configuration: !job_config!
    java -jar %CLI_JAR% -s %JENKINS_URL% create-job !job_config! < "!job_config!"
)

endlocal
